# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом
- src/components/common/ - папка с общими компонентами

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```


## Базовый код
### Класс api
Базовый класс для работы с API, реализует методы работы с ним. На основе данного класса реализуется класс взаимодействия с сервером StoreAPI.

Методы:
- get - метод для получения данных с сервера
- post - метод для отправки данных на сервер

### Класс Model<T>
Базовая модель, нужна чтобы можно было отличить ее от простых объектов с данными. На основе данного класса реализуется класс модели состояния приложения AppState.

Методы:
- emitChanges - сообщает всем, что модель поменялась

### Класс EventEmitter
Реализует паттерн Observer и используется для управления событиями, обеспечивая механизм обмена сообщениями между различными частями приложения.

Методы:
- on - вешает обработчик на событие
- off - снимает обработчик с события
- emit - инициирует событие с данными
- onAll - вешает обработчик на все события
- offAll - снимает обработчик со всех событий
- trigger - устанавливает триггер, генерирующий событие при вызове

### Класс Component<T>
Применяется для создания компонентов и реализует методы для взаимодействия с DOM.

Методы:
- toggleClass - переключает класс элемента
- addClass - добавляет класс элементу
- removeClass - удаляет класс у элемента
- setText - устанавливает текстовое содержание
- setDisabled - изменяет статус блокировки элемента
- setHidden - скрывает элемент 
- setVisible - показывает элемент
- setImage - устанавливает изображение с альтернативным текстом
- render- возвращает корневой DOM-элемент

## Компоненты модели данных
### Класс AppState
Основной класс в котором хранятся данные приложения, а так же методы для работы с ними. Наследуется от базового класса Model.

Свойства:
- catalog: IProduct[] - хранит каталог товаров
- basket: IProduct[] - хранит список товаров в корзине
- order: IOrder - хранит данные о заказе
- formErrors: IFormErrors - хранит ошибки валидации

Методы:
- setCatalog() - установка каталога товаров
- addToBasket() - добавляет товар в корзину
- removeFromBasket() - удаляет товар из корзины
- inBasket() - проверяет есть ли товар в корзине
- getTotalBasket() - отдаёт сумму товаров из корзины
- getCountBasket() - возвращает количество товаров в корзине
- setOrderFields() - заполняет данные обеих форм в заказ
- validateOrder() - проверяет валидацию формы заказа
- validateContact() - проверяет валидацию формы контактов
- clearBasket() - очищает корзину
- clearOrder() - очищает заказ

## Компоненты представления
### Класс Modal
Класс для отображения попапов. Наследуется от класса Component.

Сеттеры:
- content - устанавливает контент попапа

Методы:
- open() - открывает попап
- close() - закрывает попап
- render() - возвращает попап

### Класс Form<T>
Класс для отображения форм. Наследуется от класса Component.

Сеттеры:
- valid - устанавливает свойство валидации формы
- errors - устанавливает текст ошибок валидации формы

Методы:
- render() - возвращает форму

### Класс Basket
Класс, отвечающий за корзину. Наследуется от класса Component.

Сеттеры:
- items - устанавливает список элементов корзины
- total - устанавливает сумму заказа

### Card
Класс, отвечающий за отображение карточки товара. Наследуется от класса Component.

Сеттеры:
- image - устанавливает изображение товара
- title - устанавливает название товара
- category - устанавливает категорию товара
- price - устанавливает цену товара
- description - устанавливает описание товара
- button - устанавливает текст кнопки товара
- index - устанавливает порядковый номер товара в корзине
- inBasket - устанавливает статус наличия товара в корзине

Методы:
- updateButton() - обновляет текст кнопки добавления/удаления товара в корзину

### Page
Класс, отвечающий за вывод каталога товаров на страницу, а так же за изменение счётчика товаров в корзине, 
блокировку прокрутки при открытии попапа. Наследуется от класса Component.

Сеттеры:
- catalog - устанавливает каталог товаров
- locked - изменяет блокировку прокрутки страницы
- counter - устанавливает количество товаров в корзине

### OrderForm
Класс для отображения попапа с формой заказа. Наследуется от класса Form.
В конструкторе устанавливаются обработчики кликов на кнопки, изменяющие payment - тип оплаты заказа

Сеттеры:
- address - устанавливает адрес доставки
  
### ContactsForm
Класс для отображения попапа с формой контактов. Наследуется от класса Form.

Сеттеры:
- phone - устанавливает номер телефона
- email - устанавливает email

### Класс Success
Класс для отображения попапа успешной оплаты заказа. Наследуется от класса Component.

Сеттеры:
- total - устанавливает текст с суммой оплаты


## Взаимодействие с сервером
### Класс StoreAPI
Класс для обмена данными между приложением и сервером. Наследуется от базового класса api.

Методы:
- getProducts() - получение каталога товаров (get запрос)
- getProduct() - получение товара по его id (get запрос)
- sendOrder() - отправка данных заказа (post запрос)


## Контроллер
Контроллер (Presenter) отвечает за управление потоком данных между Моделью (Model) и Представлением (View), 
а также за обработку действий пользователя и обновление интерфейса на основе этих действий.

События:
- catalog:changed - изменение каталога товаров
- card:select - открытие попапа с карточкой товара
- basket:add - добавление товара в корзину
- basket:remove - удаление товара из корзины
- basket:open - открытие попапа корзины
- order:open - открытие попапа с формой заказа
- orderInput:change - изменение состояния полей форм
- orderFormErrors:change - изменение состояния валидации формы заказа
- order:submit - открытие попапа с формой контактов
- contactsFormErrors:change - изменение состояния валидации формы контактов
- contacts:submit - открытие попапа успешной оплаты
- modal:open - открытие попапа
- modal:close - закрытие попапа

## Основные типы данных

### interface IProduct
интерфейс описывающий поля карточки товара

- id: string - идентификатор товара
- image: string - URL адрес картинки товара
- title: string - название товара
- category: string - категория товара
- price: number | null - цена товара
- description: string - описание товара
- index: number - порядковый номер товара в корзине
- inBasket: boolean - товар в корзине Да/Нет

### interface IPage
интерфейс описывающий страницу

- counter: number - счетчик товаров в корзине
- catalog: HTMLElement[] - массив карточек с товарами
- locked: boolean - блокировка прокрутки страницы

### interface IAppState
Интерфейс состояния приложения

- catalog: IProduct[] - каталог товаров
- basket: IProduct[] - корзина с товарами

### interface IOrderForm
Интерфейс формы заказа

- payment: string - способ оплаты
- address: string - адрес

### interface IContactForm
Интерфейс формы контактов

- email: string - email
- phone: string - телефон

### interface IOrder
Интерфейс заказа

- items: string[] - товары
- total: number - сумма заказа

### interface IOrderValidate
Интерфейс валидации форм

- payment: string - способ оплаты
- address: string - адрес
- email: string - email
- phone: string - телефон

### type IFormErrors
Тип ошибок формы